# Claude Threat Scan Manual

## Overview

This guide explains how to use Claude AI for static analysis of source code security vulnerabilities. This tool detects OWASP-based vulnerabilities, hardcoded secrets, dependency security issues, and more through multi-level recursive analysis.

---

## Prerequisites

| Item | Description |
|------|-------------|
| Claude Subscription | Requires Claude Pro or Team plan |
| Prompt File | `claude_threat_scan_prompt_xxx.md` |
| Schema File | `claude-threat-scan-json-schema-xxx.md` |
| Analysis Target | Source code (zip compressed recommended, under 30MB, excluding .git, etc.) |

---

## Method 1: Claude Desktop (Using Projects Feature)

### Step 1. Create Project

1. Access Claude Desktop or claude.ai
2. Click **"+ New Project"** in the left sidebar
3. Enter project name (e.g., `Security Scanner`)

<!-- [Screenshot: Project creation screen] -->

### Step 2. Set Up Project Knowledge

1. Click **"Add content"** in project settings
2. Upload the following 2 files:
   - `claude_threat_scan_prompt_v_2.md`
   - `claude-threat-scan-json-schema-v1.2.md`

<!-- [Screenshot: File upload screen] -->

### Step 3. Configure Project Instructions

Enter the following in the Project Instructions area:

```
Analyze security vulnerabilities in the developed project files according to 
the instructions in the claude_threat_scan_prompt md file. When generating 
reports, you must refer to the schema definition in the 
claude-threat-scan-json-schema md file.
```

<!-- [Screenshot: Instructions configuration screen] -->

### Step 4. Run Security Scan

1. Open the created project
2. **Compress source code to analyze as a zip file**
3. Attach zip file to chat
4. Request as follows:

```
The attached source code is written based on [technology stack] for [service name].
Please conduct a security scan according to the specified instructions and output 
the report in the proper format.
```

**Example:**
```
The attached source code is written in Next.js/TypeScript for an OAuth token 
issuance service. Please conduct a security scan according to the specified 
instructions and output the report in the proper format.
```

### Step 5. Save Results

1. Copy the JSON result generated by Claude
2. File name format: `scanreport-YYYYMMDDhhmmss.json`
3. Save locally

---

## Method 2: Using Claude Code

### Scanning Example with Claude Code

```bash
$ cd /myproject/sourcedir

$ claude

# Scanning prompt instruction
The current folder contains the XXXX project, which runs on the XXXX platform 
and is developed based on XXXX. Please scan the current project for 
vulnerabilities according to the @claude_threat_scan_prompt_xxx.md instructions. 
The results should be output based on the schema criteria defined in the 
@claude-threat-scan-json-schema-xxx.md file.
```

---

## Viewing Results

### Using Security Reports Viewer

1. Access the Security Reports website and upload the report result JSON file directly by drag and drop
2. Click the **REPORTS** tab to upload the JSON file
3. View the visualized security report and download in your desired format

<!-- [Screenshot: Report viewer screen] -->

---

## Analysis Scope

Claude Threat Scan analyzes the following areas:

| Analysis Area | Description |
|---------------|-------------|
| Static Code Analysis | OS command execution, eval, hardcoded credentials |
| Binary Analysis | Suspicious patterns in .pyc, .so, .dll |
| Sensitive Information Detection | API keys, passwords, certificates |
| Dependency Security (SBOM) | CVE vulnerabilities, license compatibility, supply chain risks |
| Agent Policies | Tool permission policy verification |

---

## Tips

- **Large Projects**: Prioritize core business logic analysis, split by module if necessary
- **Exclude node_modules**: Recommended to exclude dependency folders before compression
- **Regular Scans**: Recommended before releases or when major changes are applied

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| File size exceeded | Select only core files, exclude node_modules |
| JSON format error | Request "Please reformat in JSON format" |
| Incomplete analysis | Request "Please continue with the rest of the analysis" |

---

## Support

For inquiries and issue reports:  
https://github.com/bosong2/securityreports/issues
