<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Threat Scan Report Viewer V2.0</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-color: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-yellow: #d29922;
            --accent-orange: #db6d28;
            --accent-red: #f85149;
            --accent-purple: #a371f7;
            --accent-cyan: #39c5cf;
            --severity-critical: #ff4757;
            --severity-high: #f85149;
            --severity-medium: #d29922;
            --severity-low: #3fb950;
            --severity-none: #8b949e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 600;
        }

        .version-badge {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .lang-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-tertiary);
            padding: 4px;
            border-radius: 8px;
        }

        .lang-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: var(--accent-blue);
            color: white;
        }

        .lang-btn:hover:not(.active) {
            background: var(--border-color);
        }

        .report-nav {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .nav-btn:hover:not(:disabled) {
            background: var(--border-color);
            border-color: var(--text-secondary);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .report-indicator {
            font-size: 13px;
            color: var(--text-secondary);
            min-width: 80px;
            text-align: center;
        }

        .file-input {
            display: none;
        }

        .action-btn {
            padding: 8px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .action-btn:hover {
            background: var(--border-color);
        }

        .action-btn.primary {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }

        .action-btn.primary:hover {
            background: #4c96eb;
        }

        .home-btn {
            padding: 8px 16px;
            background: var(--accent-green);
            border: 1px solid var(--accent-green);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
        }

        .home-btn:hover {
            background: #35a346;
            transform: translateY(-1px);
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        .summary-section {
            margin-bottom: 32px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
        }

        .summary-card-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .summary-card-value {
            font-size: 28px;
            font-weight: 600;
        }

        .summary-card-sub {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .severity-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .severity-critical {
            background: rgba(255, 71, 87, 0.15);
            color: var(--severity-critical);
            border: 1px solid rgba(255, 71, 87, 0.3);
        }

        .severity-high {
            background: rgba(248, 81, 73, 0.15);
            color: var(--severity-high);
            border: 1px solid rgba(248, 81, 73, 0.3);
        }

        .severity-medium {
            background: rgba(210, 153, 34, 0.15);
            color: var(--severity-medium);
            border: 1px solid rgba(210, 153, 34, 0.3);
        }

        .severity-low {
            background: rgba(63, 185, 80, 0.15);
            color: var(--severity-low);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .severity-none,
        .severity-info {
            background: rgba(139, 148, 158, 0.15);
            color: var(--severity-none);
            border: 1px solid rgba(139, 148, 158, 0.3);
        }

        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            user-select: none;
        }

        .section-header:hover {
            background: var(--border-color);
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 15px;
            font-weight: 600;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .section-count {
            background: var(--bg-primary);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .section-toggle {
            color: var(--text-secondary);
            transition: transform 0.2s;
        }

        .section.collapsed .section-toggle {
            transform: rotate(-90deg);
        }

        .section-content {
            padding: 16px 20px;
        }

        .section.collapsed .section-content {
            display: none;
        }

        .finding-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .finding-card:last-child {
            margin-bottom: 0;
        }

        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 12px;
        }

        .finding-id {
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 12px;
            color: var(--accent-purple);
            background: rgba(163, 113, 247, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
        }

        .finding-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }

        .finding-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 12px;
            font-size: 13px;
        }

        .finding-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
        }

        .finding-meta-label {
            color: var(--text-muted);
        }

        .finding-description {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 12px;
        }

        .finding-detail {
            background: var(--bg-secondary);
            border-radius: 6px;
            padding: 12px;
            margin-top: 12px;
        }

        .finding-detail-title {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .finding-detail-content {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .code-block {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 12px;
            overflow-x: auto;
            color: var(--text-secondary);
        }

        .repo-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .repo-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .repo-stat {
            background: var(--bg-primary);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .repo-stat-value {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .repo-stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .components-list,
        .sensitive-files-list {
            list-style: none;
        }

        .components-list li,
        .sensitive-files-list li {
            padding: 8px 12px;
            background: var(--bg-primary);
            border-radius: 6px;
            margin-bottom: 6px;
            font-size: 13px;
            font-family: 'SF Mono', 'Consolas', monospace;
        }

        .sensitive-files-list li {
            color: var(--accent-orange);
        }

        .recommendation-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid var(--accent-blue);
        }

        .recommendation-card.priority-critical {
            border-left-color: var(--severity-critical);
        }

        .recommendation-card.priority-high {
            border-left-color: var(--severity-high);
        }

        .recommendation-card.priority-medium {
            border-left-color: var(--severity-medium);
        }

        .recommendation-card.priority-low {
            border-left-color: var(--severity-low);
        }

        .recommendation-priority {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .recommendation-action {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .recommendation-rationale {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .recommendation-files {
            font-size: 12px;
            color: var(--text-muted);
            font-family: 'SF Mono', 'Consolas', monospace;
        }

        .disallowed-tools {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .tool-badge {
            background: rgba(248, 81, 73, 0.1);
            color: var(--severity-high);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-family: 'SF Mono', 'Consolas', monospace;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .empty-state-desc {
            font-size: 14px;
            max-width: 400px;
            margin: 0 auto;
        }

        .severity-summary {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .severity-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .severity-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .severity-dot.critical {
            background: var(--severity-critical);
        }

        .severity-dot.high {
            background: var(--severity-high);
        }

        .severity-dot.medium {
            background: var(--severity-medium);
        }

        .severity-dot.low {
            background: var(--severity-low);
        }

        .severity-dot.none {
            background: var(--severity-none);
        }

        .scan-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 24px;
            font-size: 13px;
        }

        .scan-meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .scan-meta-label {
            color: var(--text-muted);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .scan-meta-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* SBOM Specific Styles */
        .sbom-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .sbom-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
        }

        .sbom-card-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .license-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
        }

        .license-item {
            background: var(--bg-secondary);
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
        }

        .license-name {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .license-count {
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .risk-matrix {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .risk-matrix th,
        .risk-matrix td {
            padding: 10px 12px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .risk-matrix th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .risk-matrix td:first-child {
            text-align: left;
            font-weight: 500;
        }

        .risk-matrix .count-critical {
            color: var(--severity-critical);
            font-weight: 600;
        }

        .risk-matrix .count-high {
            color: var(--severity-high);
            font-weight: 600;
        }

        .risk-matrix .count-medium {
            color: var(--severity-medium);
            font-weight: 600;
        }

        .risk-matrix .count-low {
            color: var(--severity-low);
            font-weight: 600;
        }

        .priority-action-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .priority-rank {
            width: 32px;
            height: 32px;
            background: var(--accent-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }

        .priority-content {
            flex: 1;
        }

        .priority-package {
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .priority-version {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .priority-action-text {
            font-size: 13px;
            color: var(--accent-green);
            margin-bottom: 4px;
        }

        .priority-rationale {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .category-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 8px;
        }

        .category-vulnerability {
            background: rgba(248, 81, 73, 0.2);
            color: var(--severity-high);
        }

        .category-license {
            background: rgba(163, 113, 247, 0.2);
            color: var(--accent-purple);
        }

        .category-version {
            background: rgba(210, 153, 34, 0.2);
            color: var(--severity-medium);
        }

        .category-supplychain {
            background: rgba(57, 197, 207, 0.2);
            color: var(--accent-cyan);
        }

        .manifest-list {
            display: grid;
            gap: 8px;
        }

        .manifest-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            padding: 10px 14px;
            border-radius: 6px;
        }

        .manifest-file {
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 13px;
            color: var(--text-primary);
        }

        .manifest-stats {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .ecosystem-badge {
            background: var(--accent-blue);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            margin-right: 8px;
        }

        .cve-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .cve-badge {
            background: rgba(248, 81, 73, 0.1);
            color: var(--severity-high);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-family: 'SF Mono', 'Consolas', monospace;
        }

        .sbom-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }

        .sbom-status-item {
            background: var(--bg-secondary);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .sbom-status-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 6px;
        }

        .sbom-status-value {
            font-size: 13px;
            font-weight: 600;
        }

        .sbom-status-value.status-yes {
            color: var(--accent-green);
        }

        .sbom-status-value.status-no {
            color: var(--severity-high);
        }

        .sbom-status-value.status-na {
            color: var(--text-muted);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .header-controls {
                justify-content: center;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .main-content {
                padding: 16px;
            }

            .finding-header {
                flex-direction: column;
            }

            .sbom-overview {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            .header {
                position: relative;
            }

            .nav-btn,
            .action-btn,
            .lang-toggle {
                display: none;
            }

            .section.collapsed .section-content {
                display: block;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">CS</div>
                <span class="logo-text">Claude Threat Scan Report</span>
                <span class="version-badge">V2.0</span>
            </div>
            <div class="header-controls">
                <div class="report-nav">
                    <button class="nav-btn" id="prevReport" title="Previous Report">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M11 2L5 8l6 6" stroke="currentColor" stroke-width="2" fill="none" />
                        </svg>
                    </button>
                    <span class="report-indicator" id="reportIndicator">1 / 1</span>
                    <button class="nav-btn" id="nextReport" title="Next Report">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M5 2l6 6-6 6" stroke="currentColor" stroke-width="2" fill="none" />
                        </svg>
                    </button>
                </div>
                <div class="lang-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="ko">KO</button>
                </div>
                <input type="file" id="fileInput" class="file-input" accept=".json" multiple>
                <button class="action-btn" onclick="document.getElementById('fileInput').click()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M3.5 12.5a.5.5 0 0 1-1 0V3.5a.5.5 0 0 1 1 0v9zm1-9a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0 3a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0 3a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z" />
                    </svg>
                    Load JSON
                </button>
                <a href="index.html" class="home-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z" />
                    </svg>
                    <span data-en="Home" data-ko="Ìôà">Home</span>
                </a>
                <button class="action-btn primary" id="downloadBtn" style="display:none;"
                    onclick="downloadCurrentReport()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                        <path
                            d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                    </svg>
                    Download
                </button>
            </div>
        </div>
    </header>

    <main class="main-content" id="mainContent">
        <div class="empty-state" id="emptyState">
            <div class="empty-state-icon">üìã</div>
            <div class="empty-state-title" data-en="No Report Loaded" data-ko="Î≥¥Í≥†ÏÑúÍ∞Ä Î°úÎìúÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§">No Report Loaded</div>
            <div class="empty-state-desc"
                data-en="Click 'Load JSON' to select one or more JSON report files, or drag and drop files here."
                data-ko="'Load JSON' Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ JSON Î≥¥Í≥†ÏÑú ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò, ÌååÏùºÏùÑ Ïó¨Í∏∞Ïóê ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ÌïòÏÑ∏Ïöî.">Click 'Load JSON' to select one
                or more JSON report files, or drag and drop files here.</div>
        </div>
        <div id="reportContent" style="display: none;"></div>
    </main>

    <script>
        let reports = [];
        let currentReportIndex = 0;
        let currentLang = 'en';

        const labels = {
            en: {
                scanMetadata: 'Scan Metadata',
                scanDate: 'Scan Date',
                targetRepo: 'Target Repository',
                totalFiles: 'Total Files',
                codeFiles: 'Code Files',
                scanDepth: 'Scan Depth',
                scannerVersion: 'Scanner Version',
                repositorySummary: 'Repository Summary',
                description: 'Description',
                fileStatistics: 'File Statistics',
                keyComponents: 'Key Components',
                sensitiveFilesDetected: 'Sensitive Files Detected',
                staticCodeFindings: 'Static Code Findings',
                binaryAnalysis: 'Binary Analysis Findings',
                skillRiskFindings: 'Skill Risk Findings',
                agentPolicyFindings: 'Agent Policy Findings',
                sensitivePatterns: 'Sensitive Patterns',
                promptOptimization: 'Prompt Optimization',
                recommendations: 'Recommendations',
                file: 'File',
                line: 'Line',
                issue: 'Issue',
                severity: 'Severity',
                deepDiveResult: 'Deep Dive Result',
                recommendation: 'Recommendation',
                behaviors: 'Behaviors',
                riskSummary: 'Risk Summary',
                fragment: 'Fragment',
                riskType: 'Risk Type',
                analysis: 'Analysis',
                agent: 'Agent',
                disallowedTools: 'Disallowed Tools',
                pattern: 'Pattern',
                detail: 'Detail',
                gitignoreStatus: 'Gitignore Status',
                examples: 'Examples',
                priority: 'Priority',
                action: 'Action',
                rationale: 'Rationale',
                affectedFiles: 'Affected Files',
                critical: 'Critical',
                high: 'High',
                medium: 'Medium',
                low: 'Low',
                none: 'None',
                noFindings: 'No findings in this category',
                pythonFiles: 'Python',
                javascriptFiles: 'JavaScript',
                markdownFiles: 'Markdown',
                jsonFiles: 'JSON',
                pemFiles: 'PEM',
                otherFiles: 'Other',
                // SBOM Labels
                sbomAnalysis: 'SBOM & Dependency Analysis',
                manifestFiles: 'Manifest Files',
                dependencyStats: 'Dependency Statistics',
                licenseSummary: 'License Summary',
                vulnerabilities: 'Vulnerabilities',
                licenseIssues: 'License Issues',
                versionRisks: 'Version Risks',
                supplyChainRisks: 'Supply Chain Risks',
                sbomStatus: 'SBOM Documentation Status',
                riskMatrix: 'Risk Matrix',
                priorityActions: 'Priority Actions',
                package: 'Package',
                version: 'Version',
                currentVersion: 'Current Version',
                fixedVersion: 'Fixed Version',
                license: 'License',
                cveIds: 'CVE IDs',
                directDeps: 'Direct',
                devDeps: 'Dev',
                transitiveDeps: 'Transitive',
                sbomExists: 'SBOM File Exists',
                sbomFormat: 'SBOM Format',
                ciGeneration: 'CI/CD Generation',
                completeness: 'Completeness',
                ecosystem: 'Ecosystem',
                category: 'Category',
                yes: 'Yes',
                no: 'No',
                na: 'N/A'
            },
            ko: {
                scanMetadata: 'Ïä§Ï∫î Î©îÌÉÄÎç∞Ïù¥ÌÑ∞',
                scanDate: 'Ïä§Ï∫î ÏùºÏãú',
                targetRepo: 'ÎåÄÏÉÅ Ï†ÄÏû•ÏÜå',
                totalFiles: 'Ï†ÑÏ≤¥ ÌååÏùº',
                codeFiles: 'ÏΩîÎìú ÌååÏùº',
                scanDepth: 'Ïä§Ï∫î ÍπäÏù¥',
                scannerVersion: 'Ïä§Ï∫êÎÑà Î≤ÑÏ†Ñ',
                repositorySummary: 'Ï†ÄÏû•ÏÜå ÏöîÏïΩ',
                description: 'ÏÑ§Î™Ö',
                fileStatistics: 'ÌååÏùº ÌÜµÍ≥Ñ',
                keyComponents: 'Ï£ºÏöî Íµ¨ÏÑ± ÏöîÏÜå',
                sensitiveFilesDetected: 'ÎØºÍ∞êÌïú ÌååÏùº Í∞êÏßÄÎê®',
                staticCodeFindings: 'Ï†ïÏ†Å ÏΩîÎìú Î∂ÑÏÑù Í≤∞Í≥º',
                binaryAnalysis: 'Î∞îÏù¥ÎÑàÎ¶¨ Î∂ÑÏÑù Í≤∞Í≥º',
                skillRiskFindings: 'Ïä§ÌÇ¨ ÏúÑÌóò Î∂ÑÏÑù Í≤∞Í≥º',
                agentPolicyFindings: 'ÏóêÏù¥Ï†ÑÌä∏ Ï†ïÏ±Ö Î∂ÑÏÑù Í≤∞Í≥º',
                sensitivePatterns: 'ÎØºÍ∞êÌïú Ìå®ÌÑ¥',
                promptOptimization: 'ÌîÑÎ°¨ÌîÑÌä∏ ÏµúÏ†ÅÌôî',
                recommendations: 'Í∂åÏû• ÏÇ¨Ìï≠',
                file: 'ÌååÏùº',
                line: 'ÎùºÏù∏',
                issue: 'Ïù¥Ïäà',
                severity: 'Ïã¨Í∞ÅÎèÑ',
                deepDiveResult: 'Ïã¨Ï∏µ Î∂ÑÏÑù Í≤∞Í≥º',
                recommendation: 'Í∂åÏû• ÏÇ¨Ìï≠',
                behaviors: 'ÎèôÏûë',
                riskSummary: 'ÏúÑÌóò ÏöîÏïΩ',
                fragment: 'ÏΩîÎìú Ï°∞Í∞Å',
                riskType: 'ÏúÑÌóò Ïú†Ìòï',
                analysis: 'Î∂ÑÏÑù',
                agent: 'ÏóêÏù¥Ï†ÑÌä∏',
                disallowedTools: 'ÎπÑÌóàÏö© ÎèÑÍµ¨',
                pattern: 'Ìå®ÌÑ¥',
                detail: 'ÏÉÅÏÑ∏',
                gitignoreStatus: 'Gitignore ÏÉÅÌÉú',
                examples: 'ÏòàÏãú',
                priority: 'Ïö∞ÏÑ†ÏàúÏúÑ',
                action: 'Ï°∞Ïπò',
                rationale: 'Í∑ºÍ±∞',
                affectedFiles: 'ÏòÅÌñ• Î∞õÎäî ÌååÏùº',
                critical: 'Ïã¨Í∞Å',
                high: 'ÎÜíÏùå',
                medium: 'Ï§ëÍ∞Ñ',
                low: 'ÎÇÆÏùå',
                none: 'ÏóÜÏùå',
                noFindings: 'Ïù¥ Ïπ¥ÌÖåÍ≥†Î¶¨Ïóê Î∞úÍ≤¨Îêú Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§',
                pythonFiles: 'Python',
                javascriptFiles: 'JavaScript',
                markdownFiles: 'Markdown',
                jsonFiles: 'JSON',
                pemFiles: 'PEM',
                otherFiles: 'Í∏∞ÌÉÄ',
                // SBOM Labels
                sbomAnalysis: 'SBOM Î∞è ÏùòÏ°¥ÏÑ± Î∂ÑÏÑù',
                manifestFiles: 'Îß§ÎãàÌéòÏä§Ìä∏ ÌååÏùº',
                dependencyStats: 'ÏùòÏ°¥ÏÑ± ÌÜµÍ≥Ñ',
                licenseSummary: 'ÎùºÏù¥ÏÑ†Ïä§ ÏöîÏïΩ',
                vulnerabilities: 'Ï∑®ÏïΩÏ†ê',
                licenseIssues: 'ÎùºÏù¥ÏÑ†Ïä§ Ïù¥Ïäà',
                versionRisks: 'Î≤ÑÏ†Ñ ÏúÑÌóò',
                supplyChainRisks: 'Í≥µÍ∏âÎßù ÏúÑÌóò',
                sbomStatus: 'SBOM Î¨∏ÏÑúÌôî ÏÉÅÌÉú',
                riskMatrix: 'ÏúÑÌóò Îß§Ìä∏Î¶≠Ïä§',
                priorityActions: 'Ïö∞ÏÑ† Ï°∞Ïπò ÏÇ¨Ìï≠',
                package: 'Ìå®ÌÇ§ÏßÄ',
                version: 'Î≤ÑÏ†Ñ',
                currentVersion: 'ÌòÑÏû¨ Î≤ÑÏ†Ñ',
                fixedVersion: 'ÏàòÏ†ï Î≤ÑÏ†Ñ',
                license: 'ÎùºÏù¥ÏÑ†Ïä§',
                cveIds: 'CVE ID',
                directDeps: 'ÏßÅÏ†ë',
                devDeps: 'Í∞úÎ∞ú',
                transitiveDeps: 'Ï†ÑÏù¥',
                sbomExists: 'SBOM ÌååÏùº Ï°¥Ïû¨',
                sbomFormat: 'SBOM Ìè¨Îß∑',
                ciGeneration: 'CI/CD ÏÉùÏÑ±',
                completeness: 'ÏôÑÏ†ÑÏÑ±',
                ecosystem: 'ÏÉùÌÉúÍ≥Ñ',
                category: 'Ïπ¥ÌÖåÍ≥†Î¶¨',
                yes: 'Ïòà',
                no: 'ÏïÑÎãàÏò§',
                na: 'Ìï¥ÎãπÏóÜÏùå'
            }
        };

        function t(key) {
            return labels[currentLang][key] || key;
        }

        function getSeverityClass(severity) {
            if (!severity) return 'none';
            const s = severity.toLowerCase();
            if (s === 'critical') return 'critical';
            if (s === 'high') return 'high';
            if (s === 'medium') return 'medium';
            if (s === 'low') return 'low';
            if (s === 'info') return 'info';
            return 'none';
        }

        function getReportData(report) {
            if (currentLang === 'ko' && report.korean_report) {
                return report.korean_report;
            }
            return report.english_report;
        }

        function countSeverities(report) {
            const data = getReportData(report);
            const counts = { critical: 0, high: 0, medium: 0, low: 0, none: 0 };

            const allFindings = [
                ...(data.static_code_findings || []),
                ...(data.binary_analysis_findings || []),
                ...(data.skill_risk_findings || []),
                ...(data.agent_policy_findings || []),
                ...(data.sensitive_patterns || []),
                ...(data.prompt_optimization || [])
            ];

            // Include SBOM findings
            if (data.sbom_analysis) {
                allFindings.push(...(data.sbom_analysis.vulnerability_findings || []));
                allFindings.push(...(data.sbom_analysis.license_findings || []));
                allFindings.push(...(data.sbom_analysis.version_risk_findings || []));
                allFindings.push(...(data.sbom_analysis.supply_chain_findings || []));
            }

            allFindings.forEach(f => {
                const s = (f.severity || 'none').toLowerCase();
                if (counts[s] !== undefined) counts[s]++;
            });

            return counts;
        }

        function countSbomFindings(sbom) {
            if (!sbom) return 0;
            return (sbom.vulnerability_findings?.length || 0) +
                (sbom.license_findings?.length || 0) +
                (sbom.version_risk_findings?.length || 0) +
                (sbom.supply_chain_findings?.length || 0);
        }

        function renderScanMetadata(meta) {
            if (!meta) return '';
            return `
                <div class="scan-meta">
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('scanDate')}</span>
                        <span class="scan-meta-value">${meta.scan_date || '-'}</span>
                    </div>
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('targetRepo')}</span>
                        <span class="scan-meta-value">${meta.target_repository || '-'}</span>
                    </div>
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('totalFiles')}</span>
                        <span class="scan-meta-value">${meta.total_files || '-'}</span>
                    </div>
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('codeFiles')}</span>
                        <span class="scan-meta-value">${meta.code_files || '-'}</span>
                    </div>
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('scanDepth')}</span>
                        <span class="scan-meta-value">${meta.scan_depth || '-'}</span>
                    </div>
                    <div class="scan-meta-item">
                        <span class="scan-meta-label">${t('scannerVersion')}</span>
                        <span class="scan-meta-value">${meta.scanner_version || '-'}</span>
                    </div>
                </div>
            `;
        }

        function renderSummaryCards(report) {
            const counts = countSeverities(report);
            const meta = report.scan_metadata || {};
            const data = getReportData(report);
            const sbomCount = countSbomFindings(data.sbom_analysis);

            return `
                <div class="summary-section">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <div class="summary-card-label">${t('totalFiles')}</div>
                            <div class="summary-card-value">${meta.total_files || 0}</div>
                            <div class="summary-card-sub">${meta.target_repository || ''}</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-card-label">${t('critical')}</div>
                            <div class="summary-card-value" style="color: var(--severity-critical)">${counts.critical}</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-card-label">${t('high')}</div>
                            <div class="summary-card-value" style="color: var(--severity-high)">${counts.high}</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-card-label">${t('medium')}</div>
                            <div class="summary-card-value" style="color: var(--severity-medium)">${counts.medium}</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-card-label">${t('low')}</div>
                            <div class="summary-card-value" style="color: var(--severity-low)">${counts.low}</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-card-label">SBOM Issues</div>
                            <div class="summary-card-value" style="color: var(--accent-cyan)">${sbomCount}</div>
                        </div>
                    </div>
                    <div class="severity-summary">
                        <div class="severity-item"><span class="severity-dot critical"></span> ${t('critical')}: ${counts.critical}</div>
                        <div class="severity-item"><span class="severity-dot high"></span> ${t('high')}: ${counts.high}</div>
                        <div class="severity-item"><span class="severity-dot medium"></span> ${t('medium')}: ${counts.medium}</div>
                        <div class="severity-item"><span class="severity-dot low"></span> ${t('low')}: ${counts.low}</div>
                    </div>
                </div>
            `;
        }

        function renderRepositorySummary(summary) {
            if (!summary) return '';

            const stats = summary.file_statistics || {};

            return `
                <div class="section" id="section-repo">
                    <div class="section-header" onclick="toggleSection('section-repo')">
                        <div class="section-title">
                            <span class="section-icon">üìÅ</span>
                            ${t('repositorySummary')}
                        </div>
                        <span class="section-toggle">‚ñº</span>
                    </div>
                    <div class="section-content">
                        <div class="repo-description">${summary.description || ''}</div>

                        <h4 style="font-size: 13px; color: var(--text-muted); margin-bottom: 12px;">${t('fileStatistics')}</h4>
                        <div class="repo-stats">
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.python_files || 0}</div>
                                <div class="repo-stat-label">${t('pythonFiles')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.javascript_files || 0}</div>
                                <div class="repo-stat-label">${t('javascriptFiles')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.typescript_tsx || 0}</div>
                                <div class="repo-stat-label">TypeScript</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.markdown_files || 0}</div>
                                <div class="repo-stat-label">${t('markdownFiles')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.json_files || 0}</div>
                                <div class="repo-stat-label">${t('jsonFiles')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.other || 0}</div>
                                <div class="repo-stat-label">${t('otherFiles')}</div>
                            </div>
                        </div>

                        ${summary.key_components && summary.key_components.length > 0 ? `
                            <h4 style="font-size: 13px; color: var(--text-muted); margin: 16px 0 12px;">${t('keyComponents')}</h4>
                            <ul class="components-list">
                                ${summary.key_components.map(c => `<li>${c}</li>`).join('')}
                            </ul>
                        ` : ''}

                        ${summary.sensitive_files_detected && summary.sensitive_files_detected.length > 0 ? `
                            <h4 style="font-size: 13px; color: var(--text-muted); margin: 16px 0 12px;">${t('sensitiveFilesDetected')}</h4>
                            <ul class="sensitive-files-list">
                                ${summary.sensitive_files_detected.map(f => `<li>‚ö†Ô∏è ${f}</li>`).join('')}
                            </ul>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function renderFindingsSection(id, icon, title, findings, renderItem) {
            if (!findings) return '';

            const count = findings.length;
            const hasContent = count > 0;

            return `
                <div class="section" id="section-${id}">
                    <div class="section-header" onclick="toggleSection('section-${id}')">
                        <div class="section-title">
                            <span class="section-icon">${icon}</span>
                            ${title}
                            <span class="section-count">${count}</span>
                        </div>
                        <span class="section-toggle">‚ñº</span>
                    </div>
                    <div class="section-content">
                        ${hasContent ? findings.map(renderItem).join('') : `<p style="color: var(--text-muted); text-align: center; padding: 20px;">${t('noFindings')}</p>`}
                    </div>
                </div>
            `;
        }

        function renderStaticFindings(findings) {
            return renderFindingsSection('static', 'üîç', t('staticCodeFindings'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.issue || ''}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                    </div>
                    <div class="finding-meta">
                        <div class="finding-meta-item">
                            <span class="finding-meta-label">${t('file')}:</span>
                            <code>${f.file || '-'}</code>
                        </div>
                        ${f.line ? `
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('line')}:</span>
                                <code>${f.line}</code>
                            </div>
                        ` : ''}
                    </div>
                    <div class="finding-description">${f.description || ''}</div>
                    ${f.deep_dive_result ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('deepDiveResult')}</div>
                            <div class="finding-detail-content">${f.deep_dive_result}</div>
                        </div>
                    ` : ''}
                    ${f.recommendation ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('recommendation')}</div>
                            <div class="finding-detail-content">${f.recommendation}</div>
                        </div>
                    ` : ''}
                </div>
            `);
        }

        function renderBinaryFindings(findings) {
            return renderFindingsSection('binary', 'üíæ', t('binaryAnalysis'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.file || 'N/A'}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'None'}</span>
                    </div>
                    ${f.behaviors && f.behaviors.length > 0 ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('behaviors')}</div>
                            <div class="finding-detail-content">${f.behaviors.join(', ')}</div>
                        </div>
                    ` : ''}
                    <div class="finding-description">${f.risk_summary || ''}</div>
                </div>
            `);
        }

        function renderSkillFindings(findings) {
            return renderFindingsSection('skill', 'üõ†Ô∏è', t('skillRiskFindings'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.risk_type || ''}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                    </div>
                    <div class="finding-meta">
                        <div class="finding-meta-item">
                            <span class="finding-meta-label">${t('file')}:</span>
                            <code>${f.file || '-'}</code>
                        </div>
                    </div>
                    ${f.fragment ? `
                        <div class="code-block">${f.fragment}</div>
                    ` : ''}
                    <div class="finding-description">${f.analysis || ''}</div>
                    ${f.recommendation ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('recommendation')}</div>
                            <div class="finding-detail-content">${f.recommendation}</div>
                        </div>
                    ` : ''}
                </div>
            `);
        }

        function renderAgentFindings(findings) {
            return renderFindingsSection('agent', 'ü§ñ', t('agentPolicyFindings'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.agent || ''}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                    </div>
                    <div class="finding-meta">
                        <div class="finding-meta-item">
                            <span class="finding-meta-label">${t('file')}:</span>
                            <code>${f.file || '-'}</code>
                        </div>
                    </div>
                    <div class="finding-description">${f.issue || ''}</div>
                    ${f.disallowed_tools && f.disallowed_tools.length > 0 ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('disallowedTools')}</div>
                            <div class="disallowed-tools">
                                ${f.disallowed_tools.map(tool => `<span class="tool-badge">${tool}</span>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    ${f.recommendation ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('recommendation')}</div>
                            <div class="finding-detail-content">${f.recommendation}</div>
                        </div>
                    ` : ''}
                </div>
            `);
        }

        function renderSensitivePatterns(findings) {
            return renderFindingsSection('sensitive', 'üîê', t('sensitivePatterns'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.pattern || ''}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                    </div>
                    <div class="finding-meta">
                        <div class="finding-meta-item">
                            <span class="finding-meta-label">${t('file')}:</span>
                            <code>${f.file || '-'}</code>
                        </div>
                    </div>
                    <div class="finding-description">${f.detail || ''}</div>
                    ${f.gitignore_status ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('gitignoreStatus')}</div>
                            <div class="finding-detail-content">${f.gitignore_status}</div>
                        </div>
                    ` : ''}
                </div>
            `);
        }

        function renderPromptOptimization(findings) {
            return renderFindingsSection('prompt', 'üìù', t('promptOptimization'), findings, (f) => `
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="finding-id">${f.id || ''}</span>
                        <span class="finding-title">${f.issue || ''}</span>
                        <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                    </div>
                    <div class="finding-meta">
                        <div class="finding-meta-item">
                            <span class="finding-meta-label">${t('file')}:</span>
                            <code>${f.file || '-'}</code>
                        </div>
                    </div>
                    ${f.examples ? `
                        <div class="finding-description">${f.examples}</div>
                    ` : ''}
                    ${f.recommendation ? `
                        <div class="finding-detail">
                            <div class="finding-detail-title">${t('recommendation')}</div>
                            <div class="finding-detail-content">${f.recommendation}</div>
                        </div>
                    ` : ''}
                </div>
            `);
        }

        // SBOM Analysis Rendering Functions
        function renderSbomAnalysis(sbom) {
            if (!sbom) return '';

            const totalFindings = countSbomFindings(sbom);

            return `
                <div class="section" id="section-sbom">
                    <div class="section-header" onclick="toggleSection('section-sbom')">
                        <div class="section-title">
                            <span class="section-icon">üì¶</span>
                            ${t('sbomAnalysis')}
                            <span class="section-count">${totalFindings}</span>
                        </div>
                        <span class="section-toggle">‚ñº</span>
                    </div>
                    <div class="section-content">
                        ${renderSbomOverview(sbom)}
                        ${renderRiskMatrix(sbom.risk_matrix)}
                        ${renderPriorityActions(sbom.priority_actions)}
                        ${renderVulnerabilityFindings(sbom.vulnerability_findings)}
                        ${renderLicenseFindings(sbom.license_findings)}
                        ${renderVersionRiskFindings(sbom.version_risk_findings)}
                        ${renderSupplyChainFindings(sbom.supply_chain_findings)}
                    </div>
                </div>
            `;
        }

        function renderSbomOverview(sbom) {
            const manifests = sbom.manifest_files_found || [];
            const stats = sbom.dependency_statistics || {};
            const licenses = sbom.license_summary || {};
            const status = sbom.sbom_documentation_status || {};

            return `
                <div class="sbom-overview">
                    <!-- Manifest Files -->
                    <div class="sbom-card">
                        <div class="sbom-card-title">üìÑ ${t('manifestFiles')}</div>
                        ${manifests.length > 0 ? `
                            <div class="manifest-list">
                                ${manifests.map(m => `
                                    <div class="manifest-item">
                                        <div>
                                            <span class="ecosystem-badge">${m.ecosystem}</span>
                                            <span class="manifest-file">${m.file}</span>
                                        </div>
                                        <div class="manifest-stats">
                                            <span>${t('directDeps')}: ${m.direct_dependencies}</span>
                                            <span>${t('devDeps')}: ${m.dev_dependencies}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `<p style="color: var(--text-muted);">No manifest files found</p>`}
                    </div>

                    <!-- Dependency Statistics -->
                    <div class="sbom-card">
                        <div class="sbom-card-title">üìä ${t('dependencyStats')}</div>
                        <div class="repo-stats">
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.total_direct || 0}</div>
                                <div class="repo-stat-label">${t('directDeps')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.total_dev || 0}</div>
                                <div class="repo-stat-label">${t('devDeps')}</div>
                            </div>
                            <div class="repo-stat">
                                <div class="repo-stat-value">${stats.total_transitive || '-'}</div>
                                <div class="repo-stat-label">${t('transitiveDeps')}</div>
                            </div>
                        </div>
                    </div>

                    <!-- License Summary -->
                    <div class="sbom-card">
                        <div class="sbom-card-title">‚öñÔ∏è ${t('licenseSummary')}</div>
                        <div class="license-grid">
                            ${Object.entries(licenses).map(([name, count]) => `
                                <div class="license-item">
                                    <div class="license-name">${name}</div>
                                    <div class="license-count">${count}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- SBOM Status -->
                    <div class="sbom-card">
                        <div class="sbom-card-title">üìã ${t('sbomStatus')}</div>
                        <div class="sbom-status-grid">
                            <div class="sbom-status-item">
                                <div class="sbom-status-label">${t('sbomExists')}</div>
                                <div class="sbom-status-value ${status.sbom_file_exists ? 'status-yes' : 'status-no'}">
                                    ${status.sbom_file_exists ? t('yes') : t('no')}
                                </div>
                            </div>
                            <div class="sbom-status-item">
                                <div class="sbom-status-label">${t('sbomFormat')}</div>
                                <div class="sbom-status-value ${status.sbom_format ? 'status-yes' : 'status-na'}">
                                    ${status.sbom_format || t('na')}
                                </div>
                            </div>
                            <div class="sbom-status-item">
                                <div class="sbom-status-label">${t('ciGeneration')}</div>
                                <div class="sbom-status-value ${status.ci_sbom_generation ? 'status-yes' : 'status-no'}">
                                    ${status.ci_sbom_generation ? t('yes') : t('no')}
                                </div>
                            </div>
                            <div class="sbom-status-item">
                                <div class="sbom-status-label">${t('completeness')}</div>
                                <div class="sbom-status-value">${status.completeness || t('na')}</div>
                            </div>
                        </div>
                        ${status.recommendation ? `
                            <div class="finding-detail" style="margin-top: 12px;">
                                <div class="finding-detail-title">${t('recommendation')}</div>
                                <div class="finding-detail-content">${status.recommendation}</div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function renderRiskMatrix(matrix) {
            if (!matrix) return '';

            return `
                <div class="sbom-card" style="margin-bottom: 20px;">
                    <div class="sbom-card-title">‚ö†Ô∏è ${t('riskMatrix')}</div>
                    <table class="risk-matrix">
                        <thead>
                            <tr>
                                <th>${t('category')}</th>
                                <th>${t('critical')}</th>
                                <th>${t('high')}</th>
                                <th>${t('medium')}</th>
                                <th>${t('low')}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>${t('vulnerabilities')}</td>
                                <td class="count-critical">${matrix.vulnerabilities?.critical || 0}</td>
                                <td class="count-high">${matrix.vulnerabilities?.high || 0}</td>
                                <td class="count-medium">${matrix.vulnerabilities?.medium || 0}</td>
                                <td class="count-low">${matrix.vulnerabilities?.low || 0}</td>
                            </tr>
                            <tr>
                                <td>${t('licenseIssues')}</td>
                                <td class="count-critical">${matrix.license_issues?.critical || 0}</td>
                                <td class="count-high">${matrix.license_issues?.high || 0}</td>
                                <td class="count-medium">${matrix.license_issues?.medium || 0}</td>
                                <td class="count-low">${matrix.license_issues?.low || 0}</td>
                            </tr>
                            <tr>
                                <td>${t('versionRisks')}</td>
                                <td class="count-critical">${matrix.version_risks?.critical || 0}</td>
                                <td class="count-high">${matrix.version_risks?.high || 0}</td>
                                <td class="count-medium">${matrix.version_risks?.medium || 0}</td>
                                <td class="count-low">${matrix.version_risks?.low || 0}</td>
                            </tr>
                            <tr>
                                <td>${t('supplyChainRisks')}</td>
                                <td class="count-critical">${matrix.supply_chain?.critical || 0}</td>
                                <td class="count-high">${matrix.supply_chain?.high || 0}</td>
                                <td class="count-medium">${matrix.supply_chain?.medium || 0}</td>
                                <td class="count-low">${matrix.supply_chain?.low || 0}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderPriorityActions(actions) {
            if (!actions || actions.length === 0) return '';

            return `
                <div class="sbom-card" style="margin-bottom: 20px;">
                    <div class="sbom-card-title">üéØ ${t('priorityActions')}</div>
                    ${actions.map(a => `
                        <div class="priority-action-card">
                            <div class="priority-rank">${a.rank}</div>
                            <div class="priority-content">
                                <div class="priority-package">
                                    ${a.package}
                                    <span class="category-badge category-${(a.category || '').toLowerCase()}">${a.category}</span>
                                    <span class="severity-badge severity-${getSeverityClass(a.severity)}">${a.severity}</span>
                                </div>
                                <div class="priority-version">${t('currentVersion')}: ${a.current_version}</div>
                                <div class="priority-action-text">‚Üí ${a.action}</div>
                                <div class="priority-rationale">${a.rationale}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderVulnerabilityFindings(findings) {
            if (!findings || findings.length === 0) return '';

            return `
                <h4 style="font-size: 14px; color: var(--text-primary); margin: 20px 0 12px; display: flex; align-items: center; gap: 8px;">
                    üîì ${t('vulnerabilities')} <span class="section-count">${findings.length}</span>
                </h4>
                ${findings.map(f => `
                    <div class="finding-card">
                        <div class="finding-header">
                            <span class="finding-id">${f.id || ''}</span>
                            <span class="finding-title">${f.package}@${f.version}</span>
                            <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                        </div>
                        <div class="finding-meta">
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('file')}:</span>
                                <code>${f.file || '-'}</code>
                            </div>
                            ${f.fixed_version ? `
                                <div class="finding-meta-item">
                                    <span class="finding-meta-label">${t('fixedVersion')}:</span>
                                    <code style="color: var(--accent-green)">${f.fixed_version}</code>
                                </div>
                            ` : ''}
                        </div>
                        <div class="finding-description">${f.description || ''}</div>
                        ${f.cve_ids && f.cve_ids.length > 0 ? `
                            <div class="cve-list">
                                ${f.cve_ids.map(cve => `<span class="cve-badge">${cve}</span>`).join('')}
                            </div>
                        ` : ''}
                        ${f.recommendation ? `
                            <div class="finding-detail">
                                <div class="finding-detail-title">${t('recommendation')}</div>
                                <div class="finding-detail-content">${f.recommendation}</div>
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        function renderLicenseFindings(findings) {
            if (!findings || findings.length === 0) return '';

            return `
                <h4 style="font-size: 14px; color: var(--text-primary); margin: 20px 0 12px; display: flex; align-items: center; gap: 8px;">
                    ‚öñÔ∏è ${t('licenseIssues')} <span class="section-count">${findings.length}</span>
                </h4>
                ${findings.map(f => `
                    <div class="finding-card">
                        <div class="finding-header">
                            <span class="finding-id">${f.id || ''}</span>
                            <span class="finding-title">${f.package} - ${f.license}</span>
                            <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                        </div>
                        <div class="finding-meta">
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('file')}:</span>
                                <code>${f.file || '-'}</code>
                            </div>
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('issue')}:</span>
                                <span>${f.issue}</span>
                            </div>
                            ${f.project_license ? `
                                <div class="finding-meta-item">
                                    <span class="finding-meta-label">Project License:</span>
                                    <span>${f.project_license}</span>
                                </div>
                            ` : ''}
                        </div>
                        ${f.recommendation ? `
                            <div class="finding-detail">
                                <div class="finding-detail-title">${t('recommendation')}</div>
                                <div class="finding-detail-content">${f.recommendation}</div>
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        function renderVersionRiskFindings(findings) {
            if (!findings || findings.length === 0) return '';

            return `
                <h4 style="font-size: 14px; color: var(--text-primary); margin: 20px 0 12px; display: flex; align-items: center; gap: 8px;">
                    üìå ${t('versionRisks')} <span class="section-count">${findings.length}</span>
                </h4>
                ${findings.map(f => `
                    <div class="finding-card">
                        <div class="finding-header">
                            <span class="finding-id">${f.id || ''}</span>
                            <span class="finding-title">${f.package} - ${f.issue}</span>
                            <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                        </div>
                        <div class="finding-meta">
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('file')}:</span>
                                <code>${f.file || '-'}</code>
                            </div>
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('currentVersion')}:</span>
                                <code>${f.current_version}</code>
                            </div>
                        </div>
                        ${f.recommendation ? `
                            <div class="finding-detail">
                                <div class="finding-detail-title">${t('recommendation')}</div>
                                <div class="finding-detail-content">${f.recommendation}</div>
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        function renderSupplyChainFindings(findings) {
            if (!findings || findings.length === 0) return '';

            return `
                <h4 style="font-size: 14px; color: var(--text-primary); margin: 20px 0 12px; display: flex; align-items: center; gap: 8px;">
                    üîó ${t('supplyChainRisks')} <span class="section-count">${findings.length}</span>
                </h4>
                ${findings.map(f => `
                    <div class="finding-card">
                        <div class="finding-header">
                            <span class="finding-id">${f.id || ''}</span>
                            <span class="finding-title">${f.package} - ${f.risk_type}</span>
                            <span class="severity-badge severity-${getSeverityClass(f.severity)}">${f.severity || 'N/A'}</span>
                        </div>
                        <div class="finding-meta">
                            <div class="finding-meta-item">
                                <span class="finding-meta-label">${t('file')}:</span>
                                <code>${f.file || '-'}</code>
                            </div>
                        </div>
                        <div class="finding-description">${f.detail || ''}</div>
                        ${f.recommendation ? `
                            <div class="finding-detail">
                                <div class="finding-detail-title">${t('recommendation')}</div>
                                <div class="finding-detail-content">${f.recommendation}</div>
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        function renderRecommendations(recommendations) {
            if (!recommendations || recommendations.length === 0) return '';

            return `
                <div class="section" id="section-recommendations">
                    <div class="section-header" onclick="toggleSection('section-recommendations')">
                        <div class="section-title">
                            <span class="section-icon">‚úÖ</span>
                            ${t('recommendations')}
                            <span class="section-count">${recommendations.length}</span>
                        </div>
                        <span class="section-toggle">‚ñº</span>
                    </div>
                    <div class="section-content">
                        ${recommendations.map(r => `
                            <div class="recommendation-card priority-${(r.priority || '').toLowerCase()}">
                                <div class="recommendation-priority" style="color: var(--severity-${getSeverityClass(r.priority)})">${t('priority')}: ${r.priority}</div>
                                <div class="recommendation-action">${r.action || ''}</div>
                                <div class="recommendation-rationale">${r.rationale || ''}</div>
                                ${r.affected_files && r.affected_files.length > 0 ? `
                                    <div class="recommendation-files">${t('affectedFiles')}: ${r.affected_files.join(', ')}</div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.toggle('collapsed');
            }
        }

        function renderReport(report) {
            if (!report) return;

            const data = getReportData(report);
            const meta = report.scan_metadata;

            const html = `
                ${renderScanMetadata(meta)}
                ${renderSummaryCards(report)}
                ${renderRepositorySummary(data.repository_summary)}
                ${renderStaticFindings(data.static_code_findings)}
                ${renderBinaryFindings(data.binary_analysis_findings)}
                ${renderSkillFindings(data.skill_risk_findings)}
                ${renderAgentFindings(data.agent_policy_findings)}
                ${renderSensitivePatterns(data.sensitive_patterns)}
                ${renderPromptOptimization(data.prompt_optimization)}
                ${renderSbomAnalysis(data.sbom_analysis)}
                ${renderRecommendations(data.recommendations)}
            `;

            document.getElementById('reportContent').innerHTML = html;
            document.getElementById('reportContent').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('downloadBtn').style.display = 'flex';
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevReport');
            const nextBtn = document.getElementById('nextReport');
            const indicator = document.getElementById('reportIndicator');

            prevBtn.disabled = currentReportIndex <= 0;
            nextBtn.disabled = currentReportIndex >= reports.length - 1;
            indicator.textContent = reports.length > 0 ? `${currentReportIndex + 1} / ${reports.length}` : '0 / 0';
        }

        function loadReports(files) {
            reports = [];
            const filePromises = Array.from(files).map(file => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const json = JSON.parse(e.target.result);
                            json._filename = file.name;
                            resolve(json);
                        } catch (err) {
                            console.error('Failed to parse:', file.name, err);
                            resolve(null);
                        }
                    };
                    reader.onerror = reject;
                    reader.readAsText(file);
                });
            });

            Promise.all(filePromises).then(results => {
                reports = results.filter(r => r !== null);
                reports.sort((a, b) => {
                    const nameA = a._filename || '';
                    const nameB = b._filename || '';
                    return nameB.localeCompare(nameA);
                });

                if (reports.length > 0) {
                    currentReportIndex = 0;
                    renderReport(reports[currentReportIndex]);
                }
                updateNavigation();
            });
        }

        function downloadCurrentReport() {
            if (reports.length === 0) return;

            const report = reports[currentReportIndex];
            const filename = report._filename || 'report.json';
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Event Listeners
        document.getElementById('fileInput').addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                loadReports(e.target.files);
            }
        });

        document.getElementById('prevReport').addEventListener('click', () => {
            if (currentReportIndex > 0) {
                currentReportIndex--;
                renderReport(reports[currentReportIndex]);
                updateNavigation();
            }
        });

        document.getElementById('nextReport').addEventListener('click', () => {
            if (currentReportIndex < reports.length - 1) {
                currentReportIndex++;
                renderReport(reports[currentReportIndex]);
                updateNavigation();
            }
        });

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLang = btn.dataset.lang;

                document.querySelectorAll('[data-en]').forEach(el => {
                    el.textContent = currentLang === 'ko' ? el.dataset.ko : el.dataset.en;
                });

                if (reports.length > 0) {
                    renderReport(reports[currentReportIndex]);
                }
            });
        });

        // Drag and Drop
        document.body.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
        });

        document.body.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();

            const files = Array.from(e.dataTransfer.files).filter(f => f.name.endsWith('.json'));
            if (files.length > 0) {
                loadReports(files);
            }
        });

        // Auto-load from localStorage if available (from index.html upload)
        function checkAndLoadFromLocalStorage() {
            console.log('üîç Checking localStorage for uploaded report...');
            const storageKey = 'securityReportData';
            const storedData = localStorage.getItem(storageKey);

            if (storedData) {
                console.log('‚úÖ Found data in localStorage!', storedData.substring(0, 100) + '...');
                try {
                    const reportData = JSON.parse(storedData);
                    console.log('üì¶ Parsed report data:', reportData);

                    // Create a mock file object to use with existing loadReports
                    const jsonData = reportData.data;
                    jsonData._filename = reportData.metadata.fileName || 'Uploaded Report';

                    console.log('üìä Loading report:', jsonData._filename);

                    // Load the report
                    reports = [jsonData];
                    currentReportIndex = 0;
                    displayReport(reports[currentReportIndex]);
                    updateNavigation();

                    // Clear localStorage after loading
                    localStorage.removeItem(storageKey);
                    console.log('üóëÔ∏è Cleared localStorage');

                    console.log('‚úÖ Auto-loaded report from localStorage successfully!');
                } catch (error) {
                    console.error('‚ùå Failed to load from localStorage:', error);
                    // Clear corrupted data
                    localStorage.removeItem(storageKey);
                }
            } else {
                console.log('‚ÑπÔ∏è No data found in localStorage');
            }
        }

        // Check localStorage on page load (MUST RUN FIRST!)
        console.log('üöÄ Reports page initialized');
        checkAndLoadFromLocalStorage();
        updateNavigation();
    </script>
</body>

</html>